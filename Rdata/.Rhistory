# Chunk 9
E <- resid(ABCO.M1, type="normalized")
coplot(E ~ Ht.cm | Fire, data=dfABCO, ylab="Normalized residuals", col=dfABCO$Fire)
# Chunk 10
library(ggplot2)
Ht.cm <- c(rep(seq(0,150,length.out=61),4))
fakedata <- as.data.frame(Ht.cm)
fakedata$shrubarea <- c(rep(c( 44375,88750,133125,177500 ),61))
fakedata$Fire <- as.factor(rep("AMCR",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
dfAMCR <- subset(dfABCO, dfABCO$Fire=="AMCR")
dfCLVD <- subset(dfABCO, dfABCO$Fire=="CLVD")
dfSTAR <- subset(dfABCO, dfABCO$Fire=="STAR")
dfFRDS <- subset(dfABCO, dfABCO$Fire=="WRTS")
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
fakedata$Fire <- as.factor(rep("WRTS",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotWRTS <- ggplot(pred[pred$Ht.cm<max(dfFRDS$Ht.cm) & pred$shrubarea<=max(dfFRDS$shrubarea) & pred$shrubarea>=min(dfFRDS$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Wrights Fire")+
ylim(0,25)+
xlim(0,225)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfFRDS, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotWRTS
fakedata$Fire <- as.factor(rep("STAR",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotSTAR <- ggplot(pred[pred$Ht.cm<max(dfSTAR$Ht.cm) & pred$shrubarea<=max(dfSTAR$shrubarea) & pred$shrubarea>=min(dfSTAR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red", limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Star Fire")+
ylim(0,25)+
xlim(0,150)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfSTAR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotSTAR
fakedata$Fire <- as.factor(rep("CLVD",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotCLVD <- ggplot(pred[pred$Ht.cm<max(dfCLVD$Ht.cm) & pred$shrubarea<=max(dfCLVD$shrubarea) & pred$shrubarea>=min(dfCLVD$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Cleveland Fire")+
ylim(0,25)+
xlim(0,150)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfCLVD, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotCLVD
require(gridExtra)
all.fires <- grid.arrange(plotAMCR, plotWRTS,plotSTAR,plotCLVD,nrow=2,ncol=2 )
all.fires
# Chunk 11
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire,
weights = varPower,
data= dfABCO, method = "ML")
AIC(ABCO.M1)
AIC(update(ABCO.M1, . ~ . - Fire - Fire*Ht.cm))
ABCO.AMCR <- gls(LastYearGrth.cm ~ Ht.cm + shrubarea*Ht.cm + shrubarea,
weights = varPower,
data= dfAMCR[dfAMCR$Ht.cm<100,], method = "ML")
predicted <- predict(ABCO.AMCR, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotAMCR.2 <-ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex only model")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR.2
AMCR.compare <- grid.arrange(plotAMCR,plotAMCR.2,nrow=2,ncol=2)
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire,
weights = varPower,
data= dfABCO, method = "REML")
AIC(ABCO.M1)
AIC(update(ABCO.M1, . ~ . - Fire - Fire*Ht.cm))
ABCO.AMCR <- gls(LastYearGrth.cm ~ Ht.cm + shrubarea*Ht.cm + shrubarea,
weights = varPower,
data= dfAMCR[dfAMCR$Ht.cm<100,], method = "ML")
predicted <- predict(ABCO.AMCR, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotAMCR.2 <-ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex only model")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR.2
AMCR.compare <- grid.arrange(plotAMCR,plotAMCR.2,nrow=2,ncol=2)
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm+shrubarea+Fire,
weights = varPower,
data= dfABCO, method = "REML")
pseudoR2_ABCO(ABCO.M1)
library(ggplot2)
Ht.cm <- c(rep(seq(0,150,length.out=61),4))
fakedata <- as.data.frame(Ht.cm)
fakedata$shrubarea <- c(rep(c( 44375,88750,133125,177500 ),61))
fakedata$Fire <- as.factor(rep("AMCR",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
dfAMCR <- subset(dfABCO, dfABCO$Fire=="AMCR")
dfCLVD <- subset(dfABCO, dfABCO$Fire=="CLVD")
dfSTAR <- subset(dfABCO, dfABCO$Fire=="STAR")
dfFRDS <- subset(dfABCO, dfABCO$Fire=="WRTS")
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
fakedata$Fire <- as.factor(rep("WRTS",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotWRTS <- ggplot(pred[pred$Ht.cm<max(dfFRDS$Ht.cm) & pred$shrubarea<=max(dfFRDS$shrubarea) & pred$shrubarea>=min(dfFRDS$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Wrights Fire")+
ylim(0,25)+
xlim(0,225)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfFRDS, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotWRTS
fakedata$Fire <- as.factor(rep("STAR",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotSTAR <- ggplot(pred[pred$Ht.cm<max(dfSTAR$Ht.cm) & pred$shrubarea<=max(dfSTAR$shrubarea) & pred$shrubarea>=min(dfSTAR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red", limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Star Fire")+
ylim(0,25)+
xlim(0,150)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfSTAR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotSTAR
fakedata$Fire <- as.factor(rep("CLVD",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotCLVD <- ggplot(pred[pred$Ht.cm<max(dfCLVD$Ht.cm) & pred$shrubarea<=max(dfCLVD$shrubarea) & pred$shrubarea>=min(dfCLVD$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Cleveland Fire")+
ylim(0,25)+
xlim(0,150)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfCLVD, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotCLVD
require(gridExtra)
all.fires <- grid.arrange(plotAMCR, plotWRTS,plotSTAR,plotCLVD,nrow=2,ncol=2 )
all.fires
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire,
weights = varPower,
data= dfABCO, method = "REML")
AIC(ABCO.M1)
AIC(update(ABCO.M1, . ~ . - Fire - Fire*Ht.cm))
ABCO.AMCR <- gls(LastYearGrth.cm ~ Ht.cm + shrubarea*Ht.cm + shrubarea,
weights = varPower,
data= dfAMCR[dfAMCR$Ht.cm<100,], method = "ML")
predicted <- predict(ABCO.AMCR, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotAMCR.2 <-ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex only model")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR.2
AMCR.compare <- grid.arrange(plotAMCR,plotAMCR.2,nrow=2,ncol=2)
AIC(update(ABCO.M1, . ~ . - Fire - Fire*Ht.cm))
AIC(ABCO.M1)
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire,
weights = varPower,
data= dfABCO, method = "REML")
AIC(ABCO.M1)
AIC(update(ABCO.M1, . ~ . - Fire - Fire*Ht.cm))
ABCO.AMCR <- gls(LastYearGrth.cm ~ Ht.cm + shrubarea*Ht.cm + shrubarea,
weights = varPower,
data= dfAMCR[dfAMCR$Ht.cm<100,], method = "REML")
predicted <- predict(ABCO.AMCR, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotAMCR.2 <-ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex only model")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR.2
AMCR.compare <- grid.arrange(plotAMCR,plotAMCR.2,nrow=2,ncol=2)
# Chunk 1
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
# Chunk 2
pseudoR2_ABCO <- function(model){
meanGrth <- mean(dfABCO$LastYearGrth.cm)
sse <- (dfABCO$LastYearGrth.cm - predict(model))^2
sst <- (dfABCO$LastYearGrth.cm - meanGrth)^2
R2 <- 1 - (sum(sse)/sum(sst))
return(R2)
}
# Chunk 3
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
# Chunk 4
nrow(df[df$Species=="ABCO",])
nrow(dfABCO)
# Chunk 5
varPower <- varPower(form=~Ht.cm)
# Chunk 6
dfABCO$shrubarea <- dfABCO$Ht1.2*(dfABCO$Cov1.2)
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm+shrubarea+Fire,
weights = varPower,
data= dfABCO, method = "ML")
pseudoR2_ABCO(ABCO.M1)
AIC(ABCO.M1)
summary(ABCO.M1)
# Chunk 7
anova(ABCO.M1, update(ABCO.M1, . ~ . - shrubarea-shrubarea*Ht))
summary(ABCO.M1)
pseudoR2_ABCO(update(ABCO.M1, . ~ . - shrubarea-shrubarea*Ht))
table <- data.frame(model=character(), AIC=numeric(), stringsAsFactors=FALSE)
# Chunk 8
ABCO.M2 <- update(ABCO.M1, .~. +BasDia.cm)
AIC(ABCO.M2)
table[1,] <- c("ABCO.M1", AIC(ABCO.M1))
table <- rbind(table, c("ABCO.M2", AIC(ABCO.M2)))
table
anova(ABCO.M1,ABCO.M2)
summary(ABCO.M2)
ABCO.M3 <- update(ABCO.M1, .~. + BasDia.cm +BasDia.cm*Ht.cm)
AIC(ABCO.M3)
# Chunk 9
E <- resid(ABCO.M1, type="normalized")
coplot(E ~ Ht.cm | Fire, data=dfABCO, ylab="Normalized residuals", col=dfABCO$Fire)
# Chunk 10
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm+shrubarea+Fire,
weights = varPower,
data= dfABCO, method = "REML")
pseudoR2_ABCO(ABCO.M1)
# Chunk 11
library(ggplot2)
Ht.cm <- c(rep(seq(0,150,length.out=61),4))
fakedata <- as.data.frame(Ht.cm)
fakedata$shrubarea <- c(rep(c( 44375,88750,133125,177500 ),61))
fakedata$Fire <- as.factor(rep("AMCR",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
dfAMCR <- subset(dfABCO, dfABCO$Fire=="AMCR")
dfCLVD <- subset(dfABCO, dfABCO$Fire=="CLVD")
dfSTAR <- subset(dfABCO, dfABCO$Fire=="STAR")
dfFRDS <- subset(dfABCO, dfABCO$Fire=="WRTS")
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
fakedata$Fire <- as.factor(rep("WRTS",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotWRTS <- ggplot(pred[pred$Ht.cm<max(dfFRDS$Ht.cm) & pred$shrubarea<=max(dfFRDS$shrubarea) & pred$shrubarea>=min(dfFRDS$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Wrights Fire")+
ylim(0,25)+
xlim(0,225)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfFRDS, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotWRTS
fakedata$Fire <- as.factor(rep("STAR",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotSTAR <- ggplot(pred[pred$Ht.cm<max(dfSTAR$Ht.cm) & pred$shrubarea<=max(dfSTAR$shrubarea) & pred$shrubarea>=min(dfSTAR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red", limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Star Fire")+
ylim(0,25)+
xlim(0,150)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfSTAR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotSTAR
fakedata$Fire <- as.factor(rep("CLVD",244))
predicted <- predict(ABCO.M1, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotCLVD <- ggplot(pred[pred$Ht.cm<max(dfCLVD$Ht.cm) & pred$shrubarea<=max(dfCLVD$shrubarea) & pred$shrubarea>=min(dfCLVD$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Cleveland Fire")+
ylim(0,25)+
xlim(0,150)+
xlab("Seedling height (cm)") +
ylab("Seedling growth (cm)")+
geom_point(data=dfCLVD, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotCLVD
require(gridExtra)
all.fires <- grid.arrange(plotAMCR, plotWRTS,plotSTAR,plotCLVD,nrow=2,ncol=2 )
all.fires
# Chunk 12
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire,
weights = varPower,
data= dfABCO, method = "REML")
AIC(ABCO.M1)
AIC(update(ABCO.M1, . ~ . - Fire - Fire*Ht.cm))
ABCO.AMCR <- gls(LastYearGrth.cm ~ Ht.cm + shrubarea*Ht.cm + shrubarea,
weights = varPower,
data= dfAMCR[dfAMCR$Ht.cm<100,], method = "REML")
predicted <- predict(ABCO.AMCR, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
plotAMCR.2 <-ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex only model")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR.2
AMCR.compare <- grid.arrange(plotAMCR,plotAMCR.2,nrow=2,ncol=2)
# Chunk 13
ABCO.M1 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire + BasDia.cm,
weights = varPower,
data= dfABCO, method = "REML")
fakedata$BasDia.cm <- rep(1,244)
ABCO.M2 <- gls(LastYearGrth.cm ~ Ht.cm + Ht.cm*Fire + shrubarea*Ht.cm + shrubarea + Fire + BasDia.cm,
weights = varPower,
data= dfABCO, method = "REML")
Ht.cm <- c(rep(seq(0,150,length.out=61),4))
fakedata <- as.data.frame(Ht.cm)
fakedata$shrubarea <- c(rep(c( 44375,88750,133125,177500 ),61))
fakedata$Fire <- as.factor(rep("AMCR",244))
fakedata$BasDia.cm <- rep(1,244)
predicted <- predict(ABCO.M2, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$BasDia.cm <- fakedata$BasDia.cm
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
fakedata$BasDia.cm <- c(rep(1,122),rep(8,122))
predicted <- predict(ABCO.M2, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$BasDia.cm <- fakedata$BasDia.cm
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_line(aes(y= predicted ,group=c(shrubarea,BasDia.cm),x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_point(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
hist(dfAMCR$BasDia.cm)
fakedata$BasDia.cm <- c(rep(1,122),rep(3,122))
predicted <- predict(ABCO.M2, fakedata)
pred <- as.data.frame(predicted)
pred$shrubarea <- fakedata$shrubarea
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$BasDia.cm <- fakedata$BasDia.cm
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_point(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_point(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea,shape=BasDia.cm))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
plotAMCR <- ggplot(pred[pred$Ht.cm<max(dfAMCR$Ht.cm) & pred$shrubarea<=max(dfAMCR$shrubarea) & pred$shrubarea>=min(dfAMCR$shrubarea),])+
geom_point(aes(y= predicted ,group=shrubarea,x=Ht.cm,col=shrubarea,size=BasDia.cm))+
scale_color_gradient(low="blue",high="red",limits=c(0,max(dfABCO$shrubarea)))+
labs(title = "ABCO seedling growth ~ \nHt, shrub area, Am. Riv. Complex fire")+
ylim(0,25)+
xlim(0,125)+
xlab("Seedling height (cm)")+
ylab("Seedling growth (cm)")+
geom_point(data=dfAMCR, aes(x=Ht.cm,y=LastYearGrth.cm,col=shrubarea))
plotAMCR
