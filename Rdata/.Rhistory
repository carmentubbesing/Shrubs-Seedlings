sdlt$Species[sdlt$Species=="pipo"]<- "PIPO"
sdlt$Species[sdlt$Species=="PILA "]<- "PILA"
sdlt$Patch[sdlt$Patch=="s"]<- "S"
sdlt$FirePatch <- paste(sdlt$Fire, sdlt$Patch, sep = "-")
sdlt$FirePatch <- as.factor(sdlt$FirePatch)
summary(sdlt$FirePatch)
eck how many seedlings would be greatly affected by that difference
hist(sdlt$Ht.cm)
short <- subset(sdlt, sdlt$Ht.cm<50)
# A lot of seedlings are affected
# Check how many of those were after I left
summary(short$Personel)
hist(subset(short$Ht.cm, short$Personel %in% c("VF HH", " vf hh")))
# Check for impossible height values
sdlt$grth16 <- sdlt$Ht.cm - sdlt$Ht2015 - sdlt$LastYearGrth.cm
sort(sdlt$grth16)
ht.errors <- subset(sdlt, sdlt$grth16 < 0)
nrow(sdlt)
plot(sdlt$Ht.cm,sdlt$grth16)
plot(sdlt$Ht.cm,sdlt$LastYearGrth.cm)
### Error handling for now: include Ht.cm as variable in the model and use 2016 growth as the dependent variable
### Create data frame for analysis - start with no CADE
#sdlt <- sdlt[sdlt$Species!="CADE",]
sdlt <- sdlt[sdlt$Return==0,]
df <- sdlt[,c("Seedling.","Fire","FirePatch", "Elevation", "Species", "Slope.Deg","Aspect.deg","Ht.cm","BasDia.cm","LastYearGrth.cm","DIFN", "ImmedAboveSpp", "ImmedAboveHt.cm")]
df <- tbl_df(df)
df <- rename(df,Sdlg = Seedling.)
# Funky seedling: 17 has no growth data, intended to come back to it. Delete it from df.
df <- subset(df, df$Sdlg != "17")
################################################################################################
#PART 2.AGGREGATING SHRUB DATA BY SEEDLING
################################################################################################
### First, rename segment variable to create simpler variable called Seg that corrects typos
shr <- read.csv("Master_Compiled_shrubs.csv")
shr <- tbl_df(shr)
shr$Dead.[is.na(shr$Dead.)] <- 0
shr$Cover.cm[is.na(shr$Cover.cm)] <- 0
shr$Ht.cm[is.na(shr$Ht.cm)] <- 0
shr <- subset(shr, shr$Dead.!= 1)
shr <- subset(shr, !shr$Seedling. %in% c("ARPA-1",  "ceco-1",  "CEIN-1", "CEIN-2","chfo-1", "DCECO-1", "DCECO-2", "DCECO-3", "LIDE-1",  "LIDE-2", "LIDE-3", "LIDE-4"))
shr$Seg <- 0
for(i in 1:nrow(shr)){
if(shr$Segment[i] %in% c("0-1 m ","0 -1 m","0-1 m")){
shr$Seg[i] <- 1
} else if (shr$Segment[i]=="1-2 m "){
shr$Seg[i] <- 2
} else if (shr$Segment[i] %in% c("2-3 m","2-3m")){
shr$Seg[i] <- 3
}  else
shr$Seg[i] <- 999
}# Takes 4 seconds
# Summarize by segment and total cover
cov <- shr %>%
group_by(Seedling., Seg) %>%
summarise(cov =sum(Cover.cm)) %>%
spread(Seg, cov) %>%
rename(Sdlg = Seedling.) %>%
rename(Cov1=`1`) %>%
rename(Cov2=`2`) %>%
rename(Cov3=`3`)
# Summarize by segment and average height
ht <- shr %>%
group_by(Seedling., Seg) %>%
summarise(ht =mean(Ht.cm)) %>%
spread(Seg, ht) %>%
rename(Sdlg = Seedling.) %>%
rename(Ht1=`1`) %>%
rename(Ht2=`2`) %>%
rename(Ht3=`3`)
### Test - all should be TRUE
sum(shr[shr$Seedling.==10 & shr$Seg==1,]$Cover.cm) == cov[cov$Sdlg==10,2]
sum(shr[shr$Seedling.==1 & shr$Seg==3,]$Cover.cm) == cov[cov$Sdlg==1,4]
mean(shr[shr$Seedling.==10 & shr$Seg==1,]$Ht.cm) == ht[ht$Sdlg==10,2]
mean(shr[shr$Seedling.==1 & shr$Seg==3,]$Ht.cm) == ht[ht$Sdlg==1,4]
## Combine cover and ht values
shr_by_sdlg <- full_join(cov,ht,by="Sdlg")
### Find most common shrub species in 0-1, 1-2, and 2-3
spp <- shr %>%
group_by(Seedling.,Seg, ShrubSpp) %>%
mutate(cov=sum(Cover.cm)) %>%
ungroup %>%
group_by(Seedling.,Seg)%>%
filter(cov == max(cov)) %>%
select(Seedling.,Seg,ShrubSpp,cov) %>%
distinct(.keep_all=TRUE)
### Restructure spp so it can be binded to df
spp2 <- spp %>%
select(Seedling.,Seg, ShrubSpp) %>%
group_by(Seedling.) %>%
spread(Seg, ShrubSpp) %>%
rename(Sdlg=Seedling.) %>%
rename(Spp1=`1`) %>%
rename(Spp2=`2`) %>%
rename(Spp3=`3`)  # Check for lost seedlings
shr_by_sdlg <- full_join(shr_by_sdlg,spp2,by="Sdlg")
# Check the calculations - should be TRUE
sum(shr[shr$Seedling.==1 &shr$Seg==1 & shr$ShrubSpp=="ARPA",]$Cover.cm)==
spp[spp$ShrubSpp=="ARPA" & spp$Seedling.==1 & spp$Seg==1,]$cov[1]
max(spp[spp$Seedling.==1 &spp$Seg==1,]$cov) == spp[spp$Seedling.==1&spp$Seg==1,]$cov[1]
# Check that shrub seedlings match seedlings seedlings
nrow(df) - nrow(shr_by_sdlg)
setdiff(df$Sdlg, shr_by_sdlg$Sdlg)
setdiff(shr_by_sdlg$Sdlg, df$Sdlg)
################################################################################################
#PART 3. COMBINING SHRUB DATA WITH SEEDLING DATA
################################################################################################
df <- full_join(df, shr_by_sdlg, by="Sdlg")
# COMBINE SEGMENTS INTO PARTIAL TRANSECTS
df <- df %>%
mutate(Cov1.2 = Cov1+Cov2) %>%
mutate(Cov1.3 = Cov1.2+Cov3) %>%
mutate(Ht1.2 = (Ht1+Ht2)/2) %>%
mutate(Ht1.3 = (Ht1+Ht2+Ht3)/3)
# CREATE COLUMN FOR GENUS
df$Genus <- 0
for (i in 1:nrow(df)){
if(df$Species[i] %in% c("PILA","PIPO")){
df$Genus[i] <- "Pinus"
} else if(df$Species[i] =="CADE"){
df$Genus[i] <- "Calocedrus"
} else if(df$Species[i] =="ABCO"){
df$Genus[i] <- "Abies"
} else if(df$Species[i] =="PSME"){
df$Genus[i] <- "Pseudotsuga"
} else
df$Genus[i] <- "UHOH"
}
df$Genus <- as.factor(df$Genus)
setwd("~/Shrubs-Seedlings/Rdata")
save(df, file="master_data.Rdata")
### NEXT STEPS: ADD SLOPE VALUES AND ELEVATION VALUES WHERE THEY'RE MISSING, LOOK FOR MORE DIFN VALUES, BUILD
### A REGRESSION MODEL, AND ADD LAT AND LONG TABLE FOR EACH SEEDLING FROM PINS ON AVENZA
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
df <- df[c("Sdlg","LastYearGrth.cm","Fire","FirePatch","Species","Ht.cm","BasDia.cm","ImmedAboveSpp","Cov3","Cov2","Cov1","Cov1.2","Cov1.3","Ht1.2","Ht1.3","Ht3","Ht2","Ht1","Spp3","Spp2","Spp1")]
df <- subset(df, df1$Species != "CADE")
names(df)
summary(df$Spp1)
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Species + BasDia.cm + ImmedAboveSpp + Ht1.2 + Spp1, random = ~1|FirePatch, data= df)
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Species , random = ~1|FirePatch, data= df)
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2, random = ~1|FirePatch, data= df)
names(df)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
df <- df[c("Sdlg","LastYearGrth.cm","Fire","FirePatch","Species","Ht.cm","BasDia.cm","ImmedAboveSpp","Cov3","Cov2","Cov1","Cov1.2","Cov1.3","Ht1.2","Ht1.3","Ht3","Ht2","Ht1","Spp3","Spp2","Spp1")]
df <- subset(df, df$Species != "CADE")
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2, random = ~1|FirePatch, data= df)
df$Spp1
summary(df$Spp1)
nus
df$ShrG1 <- 0
for (i in 1:nrow(df)){
if(df$Spp1[i] %in% c("ARNE","ARPA","ARVI")){
df$ShrG1[i] <- "Arcto"
} else if(df$Spp1[i] %in% c("CECO","CEIN","CEPR")){
df$ShrG1[i] <- "Ceanothus"
} else if(df$Spp1[i] %in% c("QUVA","QUKE")){
df$ShrG1[i] <- "Quercus"
} else if(df$Spp1[i] == "LIDE"){
df$ShrG1[i] <- "LIDE"
} else if(df$Spp1[i] == "CHFO"){
df$ShrG1[i] <- "CHFO"
} else if(df$Spp1[i] == "CHSE"){
df$ShrG1[i] <- "CHSE"
} else
df$Genus[i] <- "Other"
}
df$ShrG1 <- 0
for (i in 1:nrow(df)){
if(df$Spp1[i] %in% c("ARNE","ARPA","ARVI")){
df$ShrG1[i] <- "Arcto"
} else if(df$Spp1[i] %in% c("CECO","CEIN","CEPR")){
df$ShrG1[i] <- "Ceanothus"
} else if(df$Spp1[i] %in% c("QUVA","QUKE")){
df$ShrG1[i] <- "Quercus"
} else if(df$Spp1[i] == "LIDE"){
df$ShrG1[i] <- "LIDE"
} else if(df$Spp1[i] == "CHFO"){
df$ShrG1[i] <- "CHFO"
} else if(df$Spp1[i] == "CHSE"){
df$ShrG1[i] <- "CHSE"
} else
df$ShrG1[i] <- "Other"
}
df$Genus <- 0
for (i in 1:nrow(df)){
if(df$Species[i] %in% c("PILA","PIPO")){
df$Genus[i] <- "Pinus"
} else if(df$Species[i] =="CADE"){
df$Genus[i] <- "Calocedrus"
} else if(df$Species[i] =="ABCO"){
df$Genus[i] <- "Abies"
} else if(df$Species[i] =="PSME"){
df$Genus[i] <- "Pseudotsuga"
} else
df$Genus[i] <- "UHOH"
}
df$Genus <- as.factor(df$Genus)
# Create Column for Spp1Genus
df$ShrG1 <- 0
for (i in 1:nrow(df)){
if(df$Spp1[i] %in% c("ARNE","ARPA","ARVI")){
df$ShrG1[i] <- "Arcto"
} else if(df$Spp1[i] %in% c("CECO","CEIN","CEPR")){
df$ShrG1[i] <- "Ceanothus"
} else if(df$Spp1[i] %in% c("QUVA","QUKE")){
df$ShrG1[i] <- "Quercus"
} else if(df$Spp1[i] == "LIDE"){
df$ShrG1[i] <- "LIDE"
} else if(df$Spp1[i] == "CHFO"){
df$ShrG1[i] <- "CHFO"
} else if(df$Spp1[i] == "CHSE"){
df$ShrG1[i] <- "CHSE"
} else
df$ShrG1[i] <- "Other"
}
summary(df$ShrG1)
df$ShrG1 <- as.factor(df$ShrG1)
library(dplyr)
library(tidyr)
################################################################################################
#PART 1.SEEDLING DATA EXPLORATION AND CLEANING
################################################################################################
### OPEN DATA
DATAWD <- "C:/Users/Carmen/Dropbox (Stephens Lab)/SORTIE/Shrubs_Summer16/Shrubs2016_Completed_Data_and_Photos/" # PC
setwd(DATAWD)
sdlt <- read.csv("Master_Compiled_seedlings.csv")
# Check for typos
unique(sdlt$Species)
# Correct typos and create variable for fire x patch
sdlt$Fire[sdlt$Fire=="FRED"]<- "FRDS"
sdlt$Fire[sdlt$Fire=="AMRC"]<- "AMCR"
sdlt$Species[sdlt$Species=="pipo"]<- "PIPO"
sdlt$Species[sdlt$Species=="PILA "]<- "PILA"
sdlt$Patch[sdlt$Patch=="s"]<- "S"
sdlt$FirePatch <- paste(sdlt$Fire, sdlt$Patch, sep = "-")
sdlt$FirePatch <- as.factor(sdlt$FirePatch)
# The variable Ht2015 means height to beginning of 2015 growth season. See image "Seedling Diagram"
# Issue is that some values of Ht.cm are 4 cm too large
# Check how many seedlings would be greatly affected by that difference
hist(sdlt$Ht.cm)
short <- subset(sdlt, sdlt$Ht.cm<50)
# A lot of seedlings are affected
# Check how many of those were after I left
summary(short$Personel)
hist(subset(short$Ht.cm, short$Personel %in% c("VF HH", " vf hh")))
# Check for impossible height values
sdlt$grth16 <- sdlt$Ht.cm - sdlt$Ht2015 - sdlt$LastYearGrth.cm
sort(sdlt$grth16)
ht.errors <- subset(sdlt, sdlt$grth16 < 0)
nrow(sdlt)
plot(sdlt$Ht.cm,sdlt$grth16)
plot(sdlt$Ht.cm,sdlt$LastYearGrth.cm)
### Error handling for now: include Ht.cm as variable in the model and use 2016 growth as the dependent variable
### Create data frame for analysis - start with no CADE
#sdlt <- sdlt[sdlt$Species!="CADE",]
sdlt <- sdlt[sdlt$Return==0,]
df <- sdlt[,c("Seedling.","Fire","FirePatch", "Elevation", "Species", "Slope.Deg","Aspect.deg","Ht.cm","BasDia.cm","LastYearGrth.cm","DIFN", "ImmedAboveSpp", "ImmedAboveHt.cm")]
df <- tbl_df(df)
df <- rename(df,Sdlg = Seedling.)
# Funky seedling: 17 has no growth data, intended to come back to it. Delete it from df.
df <- subset(df, df$Sdlg != "17")
################################################################################################
#PART 2.AGGREGATING SHRUB DATA BY SEEDLING
################################################################################################
### First, rename segment variable to create simpler variable called Seg that corrects typos
shr <- read.csv("Master_Compiled_shrubs.csv")
shr <- tbl_df(shr)
shr$Dead.[is.na(shr$Dead.)] <- 0
shr$Cover.cm[is.na(shr$Cover.cm)] <- 0
shr$Ht.cm[is.na(shr$Ht.cm)] <- 0
shr <- subset(shr, shr$Dead.!= 1)
shr <- subset(shr, !shr$Seedling. %in% c("ARPA-1",  "ceco-1",  "CEIN-1", "CEIN-2","chfo-1", "DCECO-1", "DCECO-2", "DCECO-3", "LIDE-1",  "LIDE-2", "LIDE-3", "LIDE-4"))
shr$Seg <- 0
for(i in 1:nrow(shr)){
if(shr$Segment[i] %in% c("0-1 m ","0 -1 m","0-1 m")){
shr$Seg[i] <- 1
} else if (shr$Segment[i]=="1-2 m "){
shr$Seg[i] <- 2
} else if (shr$Segment[i] %in% c("2-3 m","2-3m")){
shr$Seg[i] <- 3
}  else
shr$Seg[i] <- 999
}# Takes 4 seconds
# Summarize by segment and total cover
cov <- shr %>%
group_by(Seedling., Seg) %>%
summarise(cov =sum(Cover.cm)) %>%
spread(Seg, cov) %>%
rename(Sdlg = Seedling.) %>%
rename(Cov1=`1`) %>%
rename(Cov2=`2`) %>%
rename(Cov3=`3`)
# Summarize by segment and average height
ht <- shr %>%
group_by(Seedling., Seg) %>%
summarise(ht =mean(Ht.cm)) %>%
spread(Seg, ht) %>%
rename(Sdlg = Seedling.) %>%
rename(Ht1=`1`) %>%
rename(Ht2=`2`) %>%
rename(Ht3=`3`)
### Test - all should be TRUE
sum(shr[shr$Seedling.==10 & shr$Seg==1,]$Cover.cm) == cov[cov$Sdlg==10,2]
sum(shr[shr$Seedling.==1 & shr$Seg==3,]$Cover.cm) == cov[cov$Sdlg==1,4]
mean(shr[shr$Seedling.==10 & shr$Seg==1,]$Ht.cm) == ht[ht$Sdlg==10,2]
mean(shr[shr$Seedling.==1 & shr$Seg==3,]$Ht.cm) == ht[ht$Sdlg==1,4]
## Combine cover and ht values
shr_by_sdlg <- full_join(cov,ht,by="Sdlg")
### Find most common shrub species in 0-1, 1-2, and 2-3
spp <- shr %>%
group_by(Seedling.,Seg, ShrubSpp) %>%
mutate(cov=sum(Cover.cm)) %>%
ungroup %>%
group_by(Seedling.,Seg)%>%
filter(cov == max(cov)) %>%
select(Seedling.,Seg,ShrubSpp,cov) %>%
distinct(.keep_all=TRUE)
### Restructure spp so it can be binded to df
spp2 <- spp %>%
select(Seedling.,Seg, ShrubSpp) %>%
group_by(Seedling.) %>%
spread(Seg, ShrubSpp) %>%
rename(Sdlg=Seedling.) %>%
rename(Spp1=`1`) %>%
rename(Spp2=`2`) %>%
rename(Spp3=`3`)  # Check for lost seedlings
shr_by_sdlg <- full_join(shr_by_sdlg,spp2,by="Sdlg")
# Check the calculations - should be TRUE
sum(shr[shr$Seedling.==1 &shr$Seg==1 & shr$ShrubSpp=="ARPA",]$Cover.cm)==
spp[spp$ShrubSpp=="ARPA" & spp$Seedling.==1 & spp$Seg==1,]$cov[1]
max(spp[spp$Seedling.==1 &spp$Seg==1,]$cov) == spp[spp$Seedling.==1&spp$Seg==1,]$cov[1]
# Check that shrub seedlings match seedlings seedlings
nrow(df) - nrow(shr_by_sdlg)
setdiff(df$Sdlg, shr_by_sdlg$Sdlg)
setdiff(shr_by_sdlg$Sdlg, df$Sdlg)
################################################################################################
#PART 3. COMBINING SHRUB DATA WITH SEEDLING DATA
################################################################################################
df <- full_join(df, shr_by_sdlg, by="Sdlg")
# COMBINE SEGMENTS INTO PARTIAL TRANSECTS
df <- df %>%
mutate(Cov1.2 = Cov1+Cov2) %>%
mutate(Cov1.3 = Cov1.2+Cov3) %>%
mutate(Ht1.2 = (Ht1+Ht2)/2) %>%
mutate(Ht1.3 = (Ht1+Ht2+Ht3)/3)
# CREATE COLUMN FOR GENUS
df$Genus <- 0
for (i in 1:nrow(df)){
if(df$Species[i] %in% c("PILA","PIPO")){
df$Genus[i] <- "Pinus"
} else if(df$Species[i] =="CADE"){
df$Genus[i] <- "Calocedrus"
} else if(df$Species[i] =="ABCO"){
df$Genus[i] <- "Abies"
} else if(df$Species[i] =="PSME"){
df$Genus[i] <- "Pseudotsuga"
} else
df$Genus[i] <- "UHOH"
}
df$Genus <- as.factor(df$Genus)
# Create Column for Spp1Genus
df$ShrG1 <- 0
for (i in 1:nrow(df)){
if(df$Spp1[i] %in% c("ARNE","ARPA","ARVI")){
df$ShrG1[i] <- "Arcto"
} else if(df$Spp1[i] %in% c("CECO","CEIN","CEPR")){
df$ShrG1[i] <- "Ceanothus"
} else if(df$Spp1[i] %in% c("QUVA","QUKE")){
df$ShrG1[i] <- "Quercus"
} else if(df$Spp1[i] == "LIDE"){
df$ShrG1[i] <- "LIDE"
} else if(df$Spp1[i] == "CHFO"){
df$ShrG1[i] <- "CHFO"
} else if(df$Spp1[i] == "CHSE"){
df$ShrG1[i] <- "CHSE"
} else
df$ShrG1[i] <- "Other"
}
df$ShrG1 <- as.factor(df$ShrG1)
setwd("~/Shrubs-Seedlings/Rdata")
save(df, file="master_data.Rdata")
### NEXT STEPS: ADD SLOPE VALUES AND ELEVATION VALUES WHERE THEY'RE MISSING, LOOK FOR MORE DIFN VALUES, BUILD
### A REGRESSION MODEL, AND ADD LAT AND LONG TABLE FOR EACH SEEDLING FROM PINS ON AVENZA
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
df <- df[c("Sdlg","LastYearGrth.cm","Fire","FirePatch","Species","Ht.cm","BasDia.cm","ImmedAboveSpp","Cov3","Cov2","Cov1","Cov1.2","Cov1.3","Ht1.2","Ht1.3","Ht3","Ht2","Ht1","Spp3","Spp2","Spp1")]
df <- subset(df, df$Species != "CADE")
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 Spp1 + , random = ~1|FirePatch, data= df)
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2, random = ~1|FirePatch, data= df)
names(df)
load(file="master_data.Rdata")
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
getwd()
load(file="master_data.Rdata")
names(df)
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + , random = ~1|FirePatch, data= df)
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1, random = ~1|FirePatch, data= df)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
df <- subset(df, df$Species != "CADE")
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1, random = ~1|FirePatch, data= df)
summary(M1)
anova(M1)
AIC(M1)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
df <- subset(df, df$Species != "CADE")
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1, random = ~1|FirePatch, data= df)
anova(M1)
AIC(M1)
plot(M1, which=c(1))
M1.gls <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1, random = ~1|FirePatch, data= df)
E <- resid(M1.gls)
M1.gls <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch, data= df)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
df <- subset(df, df$Species != "CADE")
M1 <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1, random = ~1|FirePatch, data= df)
anova(M1)
AIC(M1)
plot(M1, which=c(1))
M1.gls <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch, data= df)
E <- resid(M1.gls)
boxplot(E ~ df$FirePatch, man = "FIrePatch")
boxplot(E ~ df$Ht.cm, main = "Seedling Height")
plot(E ~ df$Ht.cm, main = "Seedling Height")
boxplot(E ~ df$Genus, main = "Genus")
varFixed <- varFixed(~Ht.cm)
varPower <- varPower(form=~Ht.cm)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch, data= df
weights = varFixed)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch, data= df,
weights = varFixed)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1, data= df,
weights = varFixed)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm, data= df,
weights = varFixed)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm, data= df,
weights = varFixed)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varFixed,
data= df)
varFixed <- varFixed(~Ht.cm)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varFixed,
data= df)
class(df$Ht.cm)
class(df$Cov1.2)
class(df$Ht1.2)
class(df$BasDia.cm)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varFixed(~Ht.cm),
data= df)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varFixed(~BasDia.cm),
data= df)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varPower,
data= df)
library(nlme)
varFixed <- varFixed(~Ht.cm)
varPower <- varPower(form=~Ht.cm)
M1.fixed <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varPower,
data= df)
M1.fixed <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varPower,
data= df)
M1.fixed <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varFixed,
data= df)
M1.fixed <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varFixed,
data= df)
M1.power <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm,
weights = varPower,
data= df)
anova(M1.fixed, M1.power)
anova(M1.gls, M1.power)
M1.fixed <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch,
weights = varFixed,
data= df)
M1.power <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch,
weights = varPower,
data= df)
anova(M1.fixed, M1.power)
anova(M1.gls, M1.power)
M1.lme <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.2 + BasDia.cm + Genus + ShrG1 + FirePatch,
weights = varPower,
random=~1|FirePatch,
data= df, method = "REML")
anova(M1.lme)
M2.lme <- lme(LastYearGrth.cm ~ Ht.cm + Cov1.2 + FirePatch,
weights = varPower,
random=~1|FirePatch,
data= df, method = "REML")
anova(M2.lme)
M3.lme <- lme(LastYearGrth.cm ~ Ht.cm + FirePatch,
weights = varPower,
random=~1|FirePatch,
data= df, method = "REML")
anova(M2.lme, M3.lme)
