fakedata$BasDia.cm <- c(rep(2,244))
fakedata$Ht1.3 <- c(rep(c(10,80,150,220),61))
fakedata$Fire <- as.factor(c(rep("AMCR",244)))
fakedata$Cov1.2 <- c(rep(c(200,200,200,200,800,800,800,800),30),200,200,200,200)
predicted <- predict(M1F.pinus, fakedata)
pred <- as.data.frame(predicted)
pred$Ht1.3 <- fakedata$Ht1.3
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$Grth <- fakedata$LastYearGrth.cm
AMCR <- ggplot(pred)+
geom_point(aes(y= predicted ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, American Complex \nFire, for best Pinus model")+
ylim(0,55)
fakedata$Fire <- as.factor(c(rep("CLVD",244)))
predicted2 <- predict(M1F.pinus, fakedata)
pred2 <- as.data.frame(predicted2)
pred2$Ht1.3 <- fakedata$Ht1.3
pred2$Ht.cm <- fakedata$Ht.cm
pred2$Fire <- fakedata$Fire
pred2$Grth <- fakedata$LastYearGrth.cm
CLVD <- ggplot(pred2)+
geom_point(aes(y= predicted2 ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, Cleveland \nFire, for best Pinus model")+
ylim(0,55)
require(gridExtra)
grid.arrange(AMCR, CLVD,ncol=2)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1 + IAG + Fire + FIre*Ht.cm,
weights = varPower,
data= dfABCO, method = "ML")
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1 + IAG + Fire + FIre*Ht.cm,
weights = varPower,
data= dfABCO, method = "ML")
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1 + IAG + Fire + Fire*Ht.cm,
weights = varPower,
data= dfABCO, method = "ML")
anova(M1F.abco)
names(dfABCO)
M1F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire + Fire*Ht.cm + Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "REML")
Ht.cm <- c(rep(seq(0,300,5),4))
length(Ht.cm)
fakedata <- as.data.frame(Ht.cm)
fakedata$BasDia.cm <- c(rep(2,244))
fakedata$Ht1.3 <- c(rep(c(10,80,150,220),61))
fakedata$Fire <- as.factor(c(rep("AMCR",244)))
fakedata$Cov1.2 <- c(rep(c(200,200,200,200,800,800,800,800),30),200,200,200,200)
predicted <- predict(M1F.pinus, fakedata)
pred <- as.data.frame(predicted)
pred$Ht1.3 <- fakedata$Ht1.3
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$Grth <- fakedata$LastYearGrth.cm
AMCR <- ggplot(pred)+
geom_point(aes(y= predicted ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, American Complex \nFire, for best Pinus model")+
ylim(0,55)
fakedata$Fire <- as.factor(c(rep("CLVD",244)))
predicted2 <- predict(M1F.pinus, fakedata)
pred2 <- as.data.frame(predicted2)
pred2$Ht1.3 <- fakedata$Ht1.3
pred2$Ht.cm <- fakedata$Ht.cm
pred2$Fire <- fakedata$Fire
pred2$Grth <- fakedata$LastYearGrth.cm
CLVD <- ggplot(pred2)+
geom_point(aes(y= predicted2 ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, Cleveland \nFire, for best Pinus model")+
ylim(0,55)
require(gridExtra)
grid.arrange(AMCR, CLVD,ncol=2)
M1F.pipo <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire + Fire*Ht.cm + Ht.cm*Ht1.3,
weights = varPower,
data= dfPIPO, method = "REML")
Ht.cm <- c(rep(seq(0,300,5),4))
length(Ht.cm)
fakedata <- as.data.frame(Ht.cm)
fakedata$BasDia.cm <- c(rep(2,244))
fakedata$Ht1.3 <- c(rep(c(10,80,150,220),61))
fakedata$Fire <- as.factor(c(rep("AMCR",244)))
fakedata$Cov1.2 <- c(rep(c(200,200,200,200,800,800,800,800),30),200,200,200,200)
predicted <- predict(M1F.pipo, fakedata)
pred <- as.data.frame(predicted)
pred$Ht1.3 <- fakedata$Ht1.3
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$Grth <- fakedata$LastYearGrth.cm
AMCR <- ggplot(pred)+
geom_point(aes(y= predicted ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, American Complex \nFire, for best PIPO model")+
ylim(0,55)
fakedata$Fire <- as.factor(c(rep("CLVD",244)))
predicted2 <- predict(M1F.pipo, fakedata)
pred2 <- as.data.frame(predicted2)
pred2$Ht1.3 <- fakedata$Ht1.3
pred2$Ht.cm <- fakedata$Ht.cm
pred2$Fire <- fakedata$Fire
pred2$Grth <- fakedata$LastYearGrth.cm
CLVD <- ggplot(pred2)+
geom_point(aes(y= predicted2 ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, Cleveland \nFire, for best PIPO model")+
ylim(0,55)
require(gridExtra)
grid.arrange(AMCR, CLVD,ncol=2)
M2F.abco = update(M1F.abco, . ~ . - BasDia.cm)
anova(M1F.abco, M2F.abco)
M2F.abco = update(M1F.abco, . ~ . - BasDia.cm)
anova(M1F.abco, M2F.abco)
table <- rbind(table, c("M2F.abco", AIC(M2F.abco)))
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(),
AIC=numeric(), stringsAsFactors=FALSE)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + IAG + Fire + Fire*Ht.cm + Ht.cm*Ht1.3 + ImmedAboveSpp,
weights = varPower,
data= dfABCO, method = "ML")
table
table[1,] <- c("M1F.abco", AIC(M1F.abco))
table
M2F.abco = update(M1F.abco, . ~ . - BasDia.cm)
anova(M1F.abco, M2F.abco)
table <- rbind(table, c("M2F.abco", AIC(M2F.abco)))
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(), AIC=numeric(), stringsAsFactors=FALSE)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + IAG + Fire + Fire*Ht.cm + Ht.cm*Ht1.3 + ImmedAboveSpp,
weights = varPower,
data= dfABCO, method = "ML")
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(), AIC=numeric(), stringsAsFactors=FALSE)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + IAG + Fire + Fire*Ht.cm + Ht.cm*Ht1.3 + ImmedAboveSpp,
weights = varPower,
data= dfABCO, method = "ML")
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(), AIC=numeric(), stringsAsFactors=FALSE)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + IAG + Fire + Fire*Ht.cm + Ht.cm*Ht1.3 + ImmedAboveSpp,
weights = varPower,
data= dfABCO, method = "ML")
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
getwd()
load(file="master_data.Rdata")
load(file="master_data.Rdata")
load(file="master_data.Rdata")
library(nlme)
dfPinus <- df[df$Species %in% c("PIPO","PILA") & !df$Fire %in% c("PLKN","WRTS"),]
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(), AIC=numeric(), stringsAsFactors=FALSE)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + IAG + Fire + Fire*Ht.cm + Ht.cm*Ht1.3 + ImmedAboveSpp,
weights = varPower,
data= dfABCO, method = "ML")
table[1,] <- c("M1F.abco", AIC(M1F.abco))
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3
, weights = varPower,
data= dfABCO, method = "ML")
table[1,] <- c("M1F.abco", AIC(M1F.abco))
M2F.abco = update(M1F.abco, . ~ . - BasDia.cm)
anova(M1F.abco, M2F.abco)
table <- rbind(table, c("M2F.abco", AIC(M2F.abco)))
M3F.abco = update(M1F.abco, . ~ . + Fire*Ht.cm)
anova(M1F.abco, M3F.abco)
table <- rbind(table, c("M3F.abco", AIC(M3F.abco)))
summary(M3F.abco)
M3F.abco = update(M1F.abco, . ~ . + Fire*Ht.cm + Ht.cm*Ht1.3)
anova(M1F.abco, M3F.abco)
table <- rbind(table, c("M3F.abco", AIC(M3F.abco)))
table
M4F.abco = update(M3Fabco, . ~ . - Ht1.3*Ht.cm - Ht1.3 )
M4F.abco = update(M3Fabco, . ~ . - Ht1.3*Ht.cm - Ht1.3)
M4F.abco = update(M3F.abco, . ~ . - Ht1.3*Ht.cm - Ht1.3)
anova(M3F.abco, M4F.abco)
M5F.abco = update(M3F.abco, . ~ . - Cov1.2)
anova(M3F.abco, M5F.abco)
M5F.abco = update(M4F.abco, . ~ . - Cov1.2)
anova(M4F.abco, M5F.abco)
M6F.abco = update(M3F.abco, . ~ . - Cov1.2 - Ht1.3*Ht.cm)
anova(M3F.abco, M6F.abco)
M6F.abco
M3F.abco
M6F.abco
M5F.abco
M4F.abco
M3F.abco
M4F.abco = update(M3F.abco, . ~ . - Ht1.3*Ht.cm - Ht1.3 + Ht.cm)
anova(M3F.abco, M4F.abco)
table <- rbind(table, c("M4F.abco", AIC(M4F.abco)))
M6F.abco
M5F.abco
dfABCO <- df[df$Species=="ABCO" & !df$Fire %in% c("PLKN","FRDS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(), AIC=numeric(), stringsAsFactors=FALSE)
M1F.abco <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3
, weights = varPower,
data= dfABCO, method = "ML")
table[1,] <- c("M1F.abco", AIC(M1F.abco))
M2F.abco = update(M1F.abco, . ~ . - BasDia.cm)
anova(M1F.abco, M2F.abco)
table <- rbind(table, c("M2F.abco", AIC(M2F.abco)))
M3F.abco = update(M1F.abco, . ~ . + Fire*Ht.cm + Ht.cm*Ht1.3)
anova(M1F.abco, M3F.abco)
table <- rbind(table, c("M3F.abco", AIC(M3F.abco)))
M4F.abco = update(M3F.abco, . ~ . - Ht1.3*Ht.cm - Ht1.3 + Ht.cm)
anova(M3F.abco, M4F.abco)
table <- rbind(table, c("M4F.abco", AIC(M4F.abco)))
M5F.abco = update(M4F.abco, . ~ . - Cov1.2)
anova(M4F.abco, M5F.abco)
table <- rbind(table, c("M5F.abco", AIC(M5F.abco)))
M6F.abco = update(M3F.abco, . ~ . - Cov1.2 - Ht1.3*Ht.cm + Ht.cm)
anova(M3F.abco, M6F.abco)
table <- rbind(table, c("M6F.abco", AIC(M6F.abco)))
table
M6F.abco
M5F.abco
table
M7F.abco = update(M6F.abco, . ~ . - BasDia.cm)
anova(M6F.abco, M7F.abco)
table <- rbind(table, c("M7F.abco", AIC(M7F.abco)))
table
M7F.abco
dro1(M7F.abco, test="F")
drop1(M7F.abco, test="F")
table
anova(M6F.abco, M7F.abco)
setwd("~/Shrubs-Seedlings/Rdata")
load(file="master_data.Rdata")
library(nlme)
dfPinus <- df[df$Species %in% c("PIPO","PILA") & !df$Fire %in% c("PLKN","WRTS"),]
varPower <- varPower(form=~Ht.cm)
table <- data.frame(model=character(),
AIC=numeric(), stringsAsFactors=FALSE)
M1F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire + Fire*Ht.cm + Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M1F.pinus)
table[1,] <- c("M1F.pinus", AIC(M1F.pinus))
M2F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire  + Fire*Ht.cm +IAG + Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M2F.pinus)
table[2,] <- c("M2F.pinus", AIC(M2F.pinus))
M3F.pinus <- gls(LastYearGrth.cm ~  Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire  + Fire*Ht.cm +IAG ,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M3F.pinus)
table[3,] <- c("M3F.pinus", AIC(M3F.pinus))
M4F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.3 + BasDia.cm + Ht1.3 + Fire  + Fire*Ht.cm +Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M4F.pinus)
table[4,] <- c("M4F.pinus", AIC(M4F.pinus))
M5F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + Ht1.3 + Fire  + Fire*Ht.cm + Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M5F.pinus)
table[5,] <- c("M5F.pinus", AIC(M5F.pinus))
M6F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.2 + Fire + Fire*Ht.cm + Ht.cm*Ht1.2,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M6F.pinus)
table[6,] <- c("M6F.pinus", AIC(M6F.pinus))
M7F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1 + Fire + Fire*Ht.cm + Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M7F.pinus)
table[7,] <- c("M7F.pinus", AIC(M7F.pinus))
table
M8F.pinus <- gls(LastYearGrth.cm ~ Ht.cm +  BasDia.cm + Cov1.3 + Ht1.2 + Fire + Fire*Ht.cm + Ht.cm*Ht1.2,
weights = varPower,
data= dfPinus, method = "ML")
AIC(M8F.pinus)
table <- rbind(table, c("M8F.pinus", AIC(M8F.pinus)))
M9F.pinus = update(M8F.pinus, . ~ . - Cov1.3 + Cov1.2)
AIC(M9F.pinus)
table <- rbind(table, c("M9F.pinus", AIC(M9F.pinus)))
M10F.pinus = update(M8F.pinus, . ~ . - Cov1.3 + Cov1)
AIC(M10F.pinus)
table <- rbind(table, c("M10F.pinus", AIC(M10F.pinus)))
M11F.pinus = update(M8F.pinus, . ~ . - Cov1.3 + Cov1.2 - Ht1.2 + Ht1.3 - Ht.cm*Ht1.2 + Ht.cm*Ht1.3)
AIC(M10F.pinus)
table <- rbind(table, c("M11F.pinus", AIC(M11F.pinus)))
M12F.pinus = update(M1F.pinus, . ~ . - BasDia.cm)
AIC(M12F.pinus)
table <- rbind(table, c("M12F.pinus", AIC(M12F.pinus)))
anova(M12F.pinus, M1F.pinus)
M13F.pinus =  update(M1F.pinus, . ~ . + ImmedAboveHt.cm)
AIC(M13F.pinus)
table <- rbind(table, c("M13F.pinus", AIC(M13F.pinus)))
table
pred <- as.data.frame(predict(M1F.pinus))
pred$Cov <- dfPinus$Cov1.2
pred$Ht1.2 <- dfPinus$Ht1.2
pred$Ht.cm <- dfPinus$Ht.cm
pred$Fire <- dfPinus$Fire
pred$Grth <- dfPinus$LastYearGrth.cm
pred$ShrG1 <- dfPinus$ShrG1
#pred <- arrange(pred, predict(M3.lme))
library(ggplot2)
ggplot(pred)+
geom_point(aes(y=predict(M1F.pinus),x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted values, Model 6F:Pinus")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
E6F.pinus <- resid(M1F.pinus, type="normalized")
coplot(E6F.pinus ~ Ht.cm | Fire, data=dfPinus, ylab="Normalized residuals", col=dfPinus$Fire)
ggplot(pred)+
geom_point(aes(y=predict(M1F.pinus),x=Ht.cm,col=pred$ShrG1, shape=pred$Fire))+
labs(title = "Relationship between shrub species and fire, Model 6F:Pinus")
library(nlme)
# None
M1Fa.pinus <-  gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire +Fire * Ht.cm + Ht.cm * Ht1.3 ,
data= dfPinus, method = "ML")
AIC(M1Fa.pinus)
table <- rbind(table, c("M1Fa.pinus", AIC(M1Fa.pinus)))
table[2,] <- c("M2F.pinus", AIC(M2F.pinus))
M1Fb.pinus <- gls(LastYearGrth.cm ~Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire +Fire * Ht.cm + Ht.cm * Ht1.3 ,
weights = varExp(form=~ Ht.cm),
data= dfPinus, method = "ML")
AIC(M1Fb.pinus)
table <- rbind(table, c("M1Fb.pinus", AIC(M1Fb.pinus)))
M1Fc.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire +Fire * Ht.cm + Ht.cm * Ht1.3 ,
weights = varConstPower(form=~Ht.cm),
data= dfPinus, method = "ML")
AIC(M1Fc.pinus)
table <- rbind(table, c("M1Fc.pinus", AIC(M1Fc.pinus)))
table
dfPinus.D <- dfPinus[!is.na(dfPinus$DIFN),]
plot(dfPinus.D$DIFN, dfPinus.D$LastYearGrth.cm)
tableDIFN <- data.frame(model=character(),
AIC=numeric(), stringsAsFactors=FALSE)
M1D.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + DIFN + Fire +Fire * Ht.cm + Ht.cm*DIFN,
weights = varPower,
data= dfPinus.D, method = "ML")
AIC(M1D.pinus)
tableDIFN[1,] <- c("M1D.pinus", AIC(M1D.pinus))
M2D.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire +Fire * Ht.cm + Ht.cm * Ht1.3,
weights = varPower,
data= dfPinus.D, method = "ML")
AIC(M2D.pinus)
anova(M1D.pinus, M2D.pinus)
M3D.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + DIFN + Fire +Fire * Ht.cm,
weights = varPower,
data= dfPinus.D, method = "ML")
AIC(M3D.pinus)
E1D.pinus <- resid(M1D.pinus, type="normalized")
coplot(E1D.pinus ~ Ht.cm | Fire, data=dfPinus.D, ylab="Normalized residuals", main="DIFN model residuals", col=dfPinus.D$Fire)
M2D.pinus <- lme(LastYearGrth.cm ~ Ht.cm + Ht1 + BasDia.cm,
random=~1+Ht1|Fire,
weights = varPower,
data= dfPinus.D,
method = "ML")
AIC(M2D.pinus)
M4D.pinus <- gls(LastYearGrth.cm ~ Ht.cm + + DIFN + Fire + Fire*Ht.cm,
weights = varPower,
data= dfPinus.D, method = "ML")
AIC(M4D.pinus)
M5D.pinus <- gls(LastYearGrth.cm ~ Ht.cm + DIFN + Ht1.2 + Fire + Fire*Ht.cm,
weights = varPower,
data= dfPinus.D, method = "ML")
AIC(M5D.pinus)
tableDIFN <- rbind(tableDIFN, c("M5D.pinus", AIC(M5D.pinus)))
M6D.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Ht1.2 + Fire + Fire*Ht.cm,
weights = varPower,
data= dfPinus.D, method = "ML")
AIC(M6D.pinus)
tableDIFN <- rbind(tableDIFN, c("M6D.pinus", AIC(M6D.pinus)))
tableDIFN
M1F.pinus <- gls(LastYearGrth.cm ~ Ht.cm + Cov1.2 + BasDia.cm + Ht1.3 + Fire + Fire*Ht.cm + Ht.cm*Ht1.3,
weights = varPower,
data= dfPinus, method = "REML")
Ht.cm <- c(rep(seq(0,300,5),4))
length(Ht.cm)
fakedata <- as.data.frame(Ht.cm)
fakedata$BasDia.cm <- c(rep(2,244))
fakedata$Ht1.3 <- c(rep(c(10,80,150,220),61))
fakedata$Fire <- as.factor(c(rep("AMCR",244)))
fakedata$Cov1.2 <- c(rep(c(200,200,200,200,800,800,800,800),30),200,200,200,200)
predicted <- predict(M1F.pinus, fakedata)
pred <- as.data.frame(predicted)
pred$Ht1.3 <- fakedata$Ht1.3
pred$Ht.cm <- fakedata$Ht.cm
pred$Fire <- fakedata$Fire
pred$Grth <- fakedata$LastYearGrth.cm
AMCR <- ggplot(pred)+
geom_point(aes(y= predicted ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, American Complex \nFire, for best Pinus model")+
ylim(0,55)
fakedata$Fire <- as.factor(c(rep("CLVD",244)))
predicted2 <- predict(M1F.pinus, fakedata)
pred2 <- as.data.frame(predicted2)
pred2$Ht1.3 <- fakedata$Ht1.3
pred2$Ht.cm <- fakedata$Ht.cm
pred2$Fire <- fakedata$Fire
pred2$Grth <- fakedata$LastYearGrth.cm
CLVD <- ggplot(pred2)+
geom_point(aes(y= predicted2 ,x=Ht.cm,col=Ht1.3))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Predicted seedling growth ~ \nHt, shrub height (Ht1.3) \nand shrub cover, Cleveland \nFire, for best Pinus model")+
ylim(0,55)
require(gridExtra)
grid.arrange(AMCR, CLVD,ncol=2)
pred$Species <- dfPinus$Species
pred <- as.data.frame(predict(M1F.pinus))
pred$Cov <- dfPinus$Cov1.2
pred$Ht1.2 <- dfPinus$Ht1.2
pred$Ht.cm <- dfPinus$Ht.cm
pred$Fire <- dfPinus$Fire
pred$Grth <- dfPinus$LastYearGrth.cm
pred$ShrG1 <- dfPinus$ShrG1
pred$Species <- dfPinus$Species
library(ggplot2)
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire, size=pred$Species))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
pred[pred$Species=="PINUS",]
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pred[pred$Species=="PINUS",], aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire, size=2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pred[pred$Species=="PINUS",], aes(y=Grth,x=Ht.cm,col=pred[pred$Species=="PINUS",]$Ht1.2, shape=pred[pred$Species=="PINUS",]$Fire, size=2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pred[pred$Species=="PINUS",], aes(y=Grth,x=Ht.cm, size=2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(aes(data=pred[pred$Species=="PINUS",],y=Grth,x=Ht.cm, size=2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(data=pred[pred$Species=="PINUS",])+
geom_point(aes(y=predict(M1F.pinus),x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))
pred[pred$Species=="PILA",]
ggplot(data=pred[pred$Species=="PILA",])+
geom_point(aes(y=predict(M1F.pinus),x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))
ggplot(pred[pred$Species=="PILA",])+
geom_point(aes(y=predict(M1F.pinus),x=Ht.cm))
pila <- pred[pred$Species=="PILA",]
pila
ggplot(pila)+
geom_point(aes(y=predict(M1F.pinus),x=Ht.cm))
pila
ggplot(pila)+
geom_point(aes(y=pila$predict(M1F.pinus),x=pila$Ht.cm))
pila$predict(M1F.pinus
pila$predict(M1F.pinus)
nrow(pila)
pila$predict(M1F.pinus)
pila
pila[2]
ggplot(pila)+
geom_point(aes(y=pila[1],x=pila$Ht.cm))
ggplot(pila)+
geom_point(data=pila, aes(y=pila[1],x=pila$Ht.cm))
ggplot(pila)+
geom_point(data=pila, aes(y=pila[1],x=pila$Ht.cm, size=2))
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pila, aes(y=pila[1],x=pila$Ht.cm, size=2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pila, aes(y=pila[1],x=pila$Ht.cm, size=2, shape=pila$Fire))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pila, aes(y=pila[1],x=pila$Ht.cm, size=2, shape=pila$Fire, col=pila$Ht1.2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values")
ggplot(pred)+
geom_point(aes(y=Grth,x=Ht.cm,col=pred$Ht1.2, shape=pred$Fire))+
geom_point(data=pila, aes(y=pila[1],x=pila$Ht.cm, size=2, shape=pila$Fire, col=pila$Ht1.2))+
scale_color_gradient(low="blue",high="red")+
labs(title = "Measured values, with larger symbols for PILA than PIPO")
